"use strict";var e=require("path"),r=process.cwd(),i=require(e.join(r,"settings")),d=require("node-uuid"),s=require("speedt-utils").md5,t=require("speedt-utils").utils,u=require("emag.db").mysql,a=require("emag.db").redis,_=require("emag.cfg"),o=require("emag.biz"),p=require("underscore");p.str=require("underscore.string"),p.mixin(p.str.exports()),function(){exports=module.exports=function(e,r){u.query("SELECT e.prop_name game_prop_name, d.type_name gift_type_name, c.goods_name, b.user_name, b.vip user_vip, a.* FROM (SELECT * FROM w_gift WHERE user_id=?) a LEFT JOIN s_user b ON (a.user_id=b.id) LEFT JOIN w_goods c ON (a.goods_id=c.id) LEFT JOIN w_gift_type d ON (a.gift_type=d.id) LEFT JOIN w_game_prop e ON (a.game_prop_id=e.id) WHERE b.id IS NOT NULL AND c.id IS NOT NULL AND d.id IS NOT NULL AND e.id IS NOT NULL ORDER BY a.create_time DESC",[e||0],r)}}();