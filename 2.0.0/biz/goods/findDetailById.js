"use strict";var e=require("path"),r=process.cwd(),i=require(e.join(r,"settings")),o=require("node-uuid"),s=require("speedt-utils").md5,u=require("speedt-utils").utils,d=require("emag.db").mysql,t=require("emag.db").redis,n=require("emag.cfg"),a=require("emag.biz"),m=require("underscore");m.str=require("underscore.string"),m.mixin(m.str.exports()),function(){exports=module.exports=function(e,r){return new Promise(function(i,o){(r||d).query("SELECT c.prop_name game_prop_name, b.goods_name, a.* FROM (SELECT * FROM w_goods_detail WHERE goods_id=?) a LEFT JOIN w_goods b ON (a.goods_id=b.id) LEFT JOIN w_game_prop c ON (a.game_prop_id=c.id) WHERE b.id IS NOT NULL AND c.id IS NOT NULL ORDER BY a.create_time DESC",[e],function(e,r){if(e)return o(e);i(r)})})}}();