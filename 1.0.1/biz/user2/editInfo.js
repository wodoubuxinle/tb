"use strict";var e=require("path"),r=process.cwd(),i=require(e.join(r,"settings")),u=require("node-uuid"),s=require("speedt-utils").md5,n=require("speedt-utils").utils,t=require("emag.db").mysql,c=require("emag.db").redis,o=require("emag.cfg"),d=require("emag.biz"),q=require("underscore");q.str=require("underscore.string"),q.mixin(q.str.exports()),function(){exports=module.exports=function(e,r){return e.current_score=e.current_score||0,e.vip=e.vip||0,new Promise(function(i,u){(r||t).query("UPDATE s_user SET nickname=?, current_score=?, vip=? WHERE id=?",[e.nickname,e.current_score,e.vip,e.id],function(r){if(r)return u(r);i(e)})})}}();