"use strict";var e=require("path"),r=process.cwd(),s=require(e.join(r,"settings")),i=require("node-uuid"),u=require("speedt-utils").md5,t=require("speedt-utils").utils,n=require("emag.db").mysql,o=require("emag.db").redis,c=require("emag.cfg"),m=require("emag.biz"),d=require("underscore");d.str=require("underscore.string"),d.mixin(d.str.exports()),function(){function e(e,r){return r?1!==r.status?Promise.reject("禁用状态"):u.hex(e.user_pass)!==r.user_pass?Promise.reject("用户名或密码输入错误"):Promise.resolve(r):Promise.reject("用户不存在")}exports=module.exports=function(r){return new Promise(function(s,i){m.user2.getByName(r.user_name).then(e.bind(null,r)).then(function(e){return s(e)}).catch(i)})}}();