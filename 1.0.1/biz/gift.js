"use strict";var e=require("path"),i=process.cwd(),r=require(e.join(i,"settings")),t=require("node-uuid"),d=require("underscore"),a=require("speedt-utils").md5,u=require("speedt-utils").utils,s=require("emag.db").mysql,_=require("emag.db").redis,g=require("emag.cfg"),o=require("emag.biz"),n=require("log4js").getLogger("biz.gift");!function(){exports.findAll=function(e,i){s.query("SELECT e.prop_name game_prop_name, d.type_name gift_type_name, c.goods_name, b.user_name, b.vip user_vip, a.* FROM (SELECT * FROM w_gift WHERE user_id=?) a LEFT JOIN s_user b ON (a.user_id=b.id) LEFT JOIN w_goods c ON (a.goods_id=c.id) LEFT JOIN w_gift_type d ON (a.gift_type=d.id) LEFT JOIN w_game_prop e ON (a.game_prop_id=e.id) WHERE b.id IS NOT NULL AND c.id IS NOT NULL AND d.id IS NOT NULL AND e.id IS NOT NULL ORDER BY a.create_time DESC",[e||0],i)}}(),function(){exports.findGiftByDate=function(e,i,r,t){s.query("SELECT a.* FROM w_gift a WHERE a.user_id=? AND a.gift_type=? AND DATE(a.create_time)=?",[e,i||1,r||u.formatDate(new Date,"YYYY-MM-dd")],t)}}();