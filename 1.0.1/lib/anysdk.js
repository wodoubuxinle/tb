"use strict";var e=require("path"),r=process.cwd(),t=require(e.join(r,"settings")),n=require("crypto"),a=require("http"),i=require("speedt-utils").ajax;!function(){exports.payment=function(e){return r(e,t.anysdk.private_key)&&a(e,t.anysdk.enhanced_key)};var e=function(e){return e=new Buffer(e).toString("binary"),n.createHash("md5").update(e).digest("hex").toLowerCase()},r=function(e,r){var t=e.sign;return delete e.sign,t==i(e,r)},a=function(e,r){var t=e.enhanced_sign;return delete e.enhanced_sign,delete e.sign,t==i(e,r)},i=function(r,t){var n=[];for(var a in r)n.push(a);n=n.sort();var i="";for(var o in n)i+=r[n[o]];return e(e(i)+t)}}(),function(){exports.wx=function(e){return e=e||{},new Promise(function(r,t){i(a.request,{host:"oauth.anysdk.com",port:80,path:"/api/User/LoginOauth/",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}},e,null).then(function(e){try{var n=JSON.parse(e)}catch(e){return t(e)}if("ok"===n.status)return r(n);t(n.data.error)}).catch(t)})}}();